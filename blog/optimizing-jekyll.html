<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <title>Optimizing Jekyll - Brett Stevenson</title>
  <meta name="description" content="Developer &#x1f784; Designer &#x1f784; Student"/>
  
  <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Optimizing Jekyll | Brett Stevenson</title>
<meta property="og:title" content="Optimizing Jekyll" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Some insight into how to improve the performance of your Jekyll website" />
<meta property="og:description" content="Some insight into how to improve the performance of your Jekyll website" />
<link rel="canonical" href="https://brettstevenson.io/blog/optimizing-jekyll.html" />
<meta property="og:url" content="https://brettstevenson.io/blog/optimizing-jekyll.html" />
<meta property="og:site_name" content="Brett Stevenson" />
<meta property="og:image" content="https://brettstevenson.io/web-performance.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-04-10T00:00:00+00:00" />
<script type="application/ld+json">
{"name":null,"description":"Some insight into how to improve the performance of your Jekyll website","url":"https://brettstevenson.io/blog/optimizing-jekyll.html","headline":"Optimizing Jekyll","dateModified":"2017-04-10T00:00:00+00:00","datePublished":"2017-04-10T00:00:00+00:00","sameAs":null,"@type":"BlogPosting","author":null,"image":"https://brettstevenson.io/web-performance.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://brettstevenson.io/assets/img/logo.png"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://brettstevenson.io/blog/optimizing-jekyll.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  
    <!-- Open graph tags -->
<meta property="og:type" content="article">
<meta property="og:url" content="https://brettstevenson.io/blog/optimizing-jekyll.html">
<meta name="twitter:url" content="https://brettstevenson.io/blog/optimizing-jekyll.html">
<meta property="og:image" content="https://brettstevenson.io/assets/img/posts/web-performance.png">
<meta property="og:site_name" content="Brett Stevenson">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@vdaubry">
<meta name="twitter:creator" content="@vdaubry">


  <meta property="og:title" content="Optimizing Jekyll">
  <meta name="twitter:title" content="Optimizing Jekyll">



  <meta property="og:description" content="Some insight into how to improve the performance of your Jekyll website">
  <meta name="twitter:description" content="Some insight into how to improve the performance of your Jekyll website">



  <meta property="og:image" content="https://brettstevenson.io/assets/img/posts/web-performance.png">
  <meta name="twitter:image:src" content="https://brettstevenson.io/https://brettstevenson.io/assets/img/posts/web-performance.png">





  <meta property="article:published_time" content="2017-04-10T00:00:00+00:00">
  <meta property="article:author" content="">



  
    <meta property="article:section" content="blog">
  



  
    <meta property="article:tag" content="Jekyll">
  
    <meta property="article:tag" content="Web Development">
  
    <meta property="article:tag" content="Performance">
  
    <meta property="article:tag" content="Gulp">
  
    <meta property="article:tag" content="Javascript">
  
    <meta property="article:tag" content="Node.js">
  
    <meta property="article:tag" content="GitHub Pages">
  
    <meta property="article:tag" content="Cloudflare">
  


  

  <link rel="canonical" href="https://brettstevenson.io/blog/optimizing-jekyll.html">
  <style>body:before{white-space:pre;font-family:monospace;content:"Error: Invalid CSS after \"...te(0, 0, 0); */\": expected \"{\", was \"}\"\A         on line 6 of _assets/styles/critical.scss\A \A 1: @import 'libs/mixins';\A 2: @import 'libs/skel';\A 3: @import 'libs/breakpoints';\A 4: \A 5: @keyframes scroll-bounce {\A 6:   0% { transform: rotate(-45deg) translate(0, 0, 0); */}\A 7:   30% { transform: rotate(-45deg) translate(-10px, 10px, 0); }\A 8:   50% { transform: rotate(-45deg) translate(0, 0, 0); }\A 9: }\A 10: \A 11: #banner {"}</style>
  <script src="/assets/js/load-css.js" type="text/javascript"></script>

  <noscript>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i|Merriweather:300,300i,400,400i,700,700i,900,900i' rel='stylesheet' type='text/css'/>
    <link rel="stylesheet" href="/assets/fonts/AvenirNext.css"/>
    <link rel="stylesheet" href="/assets/fonts/GothamHTF.css"/>
    <link rel="stylesheet" href="/assets/fonts/FiraCode.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css"/>
    <link href="/assets/styles/main.css" rel='stylesheet' type='text/css'/>
  </noscript>

  
    
    
  <style>
    #main > header {
      background-image: -moz-linear-gradient(top, rgba(0,0,0,0.25), rgba(0,0,0,0.25)), url("/assets/img/web-performance.png") !important;
      background-image: -webkit-linear-gradient(top, rgba(0,0,0,0.25), rgba(0,0,0,0.25)), url("/assets/img/web-performance.png") !important;
      background-image: -ms-linear-gradient(top, rgba(0,0,0,0.25), rgba(0,0,0,0.25)), url("/assets/img/web-performance.png") !important;
      background-image: linear-gradient(top, rgba(0,0,0,0.25), rgba(0,0,0,0.25)), url("/assets/img/web-performance.png") !important;
    }
  </style>
  
  

  
  <link rel="alternate" type="application/rss+xml" title="Brett Stevenson" href="https://brettstevenson.io/feed.xml"/>
</head>

  <body class="post-content" role="main">
    
<header id="header"  class="alt ">
  <h1><a href="/index.html">
  
    <img class="header-logo" src="/assets/img/logo.png" alt="logo"/><span class="animated fadeIn">Brett Stevenson</span>
  
  </a></h1>
  <nav id="nav">
    <ul>
      <li class="special">
        
          <a class="menu-toggle" id="menuToggle" href="#menu"><span></span></a>
        
        <div id="menu"  class="post-menu" >
          <ul class="menu-page-list">
            <li class="menu-page-link"><a href="/index.html">Home</a></li>
            
            
              
                
                <li class="menu-page-link"><a href="/dev/">Developer</a></li>
                
              
            
              
                
                <li class="menu-page-link"><a href="/design/">Designer</a></li>
                
              
            
              
                
                <li class="menu-page-link"><a href="/blog/">Blog</a></li>
                
              
            
              
                
              
            
              
                
                <li class="menu-page-link"><a href="/contact/">Contact</a></li>
                
              
            
              
                
              
            
              
                
              
            
              
                
              
            
              
                
              
            
              
            
              
            
              
                
              
            
              
            
              
            
              
                
              
            
          </ul>
        </div>
      </li>
    </ul>
  </nav>
</header>

    <div class=" post">
      <a class="back-post" href="/blog"><i class="fa fa-chevron-left"></i><span class="animated fadeIn">Back to Blog</span></a>
      
        <section class="post-image" style=" background: linear-gradient(rgba(0,0,0,0.25), rgba(0,0,0,0.25)), url(/assets/img/posts/web-performance.png); ">
          <div class="post-meta">
            <h1 class="post-title">Optimizing Jekyll</h1>
          </div>
        </section>
      
      
        <div class="post-wrapper">
          <div class="post-header">
            <h1 class="post-title">Optimizing Jekyll</h1>
            <div class="date-container">
              <span class="date"><strong style="margin-right:-2px">10</strong>&nbsp;Apr&nbsp;<strong>2017</strong></span>
              <svg class="ico-svg" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><use xlink:href="/assets/img/sprite-icons.svg#calendar" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
            </div>
          </div>
          <section id="content" class="written-content">
            <a name="top"></a>
            <p class="h-tip">
  For a more up-to-date and comprehensive explanation this subject has been revisited <a href="https://brettstevenson.io/blog/optimizing-jekyll-with-gulp-revisited.html">here</a>
  </p>

<p>Upon launching my new redesigned website, I’ve been spending the some time optimizing the site performance and load speeds using <strong><a href="https://developers.google.com/speed/pagespeed/insights/?url=http%3A%2F%2Ftterb.github.io%2F&amp;tab=mobile">Google PageSpeed Insights</a></strong>.
  Therefore, I thought I would take a second to share with you my discoveries and also recommend a few helpful resources for improving the performance of your own Jekyll website.
  Using these methods, I have managed to receive the following PageSpeed rating. Though this is still a work-in-progress, and I will be adding <a href="#updates">updates</a> as I explore this topic further.</p>

<p align="center">
  <img src="https://user-images.githubusercontent.com/16360374/27520456-f313f3de-59c0-11e7-81ce-40273d1ffcbb.png" class="shadow" width="800" alt="PageSpeed" style="margin-bottom:0.5em" />
</p>

<p class="h-note" style="margin-bottom:3em">In an effort not to repeat the information in the articles listed below, I'll only share findings that weren't explicitly discussed in any of the following resources.</p>

<h3 id="optimize-your-own-images">Optimize your own images</h3>
<p>As with most websites, when I first launched the new design, the biggest hindrance to my websites loading speed was the size of the images on my page. Though, after observing the disappointing quality of the “<em>optimized</em>” images provided by PageSpeed Insights, I instead elected to use <strong><a href="https://www.gimp.org/">GIMP</a></strong> to manually decrease and compress my images to preserve the image quality until PageSpeeds requirements were satisfied.
  I would highly recommend doing the same, particularly for images that are featured in various places throughout your website.</p>

<hr />

<h3 id="resources">Resources:</h3>
<ul>
  <li><strong><a href="https://medium.com/@dimitrikoenig/scoring-100-on-googles-pagespeed-insights-with-jekyll-adcbbb229baf">Scoring 100 on Google’s PageSpeed Insights with Jekyll</a></strong></li>
  <li><strong><a href="https://chrishallahan.com/blog/pass-google-pagespeed-performance-test">How to get your Jekyll + GitHub pages website to pass Google’s PageSpeed Tests</a></strong></li>
  <li><strong><a href="http://o.zasadnyy.com/blog/optimized-jekyll-site-with-grunt/">Optimized Jekyll site with Grunt</a></strong></li>
</ul>

<hr />

<h3 id="the-results">The Results</h3>
<p>I’ve provided my resulting Gulpfile below, though it’s also available via <strong><a href="https://gist.github.com/tterb/741b353d9a2a19947d2b10a9c94de21f">gist</a></strong>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp'</span><span class="p">),</span>
    <span class="nx">shell</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-shell'</span><span class="p">),</span>
    <span class="nx">minifyHTML</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-minify-html'</span><span class="p">),</span>
    <span class="nx">minifyCSS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-minify-css'</span><span class="p">),</span>
    <span class="nx">sass</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-sass'</span><span class="p">),</span>
    <span class="nx">importCss</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-import-css'</span><span class="p">),</span>
    <span class="nx">autoprefixer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-autoprefixer'</span><span class="p">),</span>
    <span class="nx">rename</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-rename'</span><span class="p">),</span>
    <span class="nx">imagemin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-imagemin'</span><span class="p">),</span>
    <span class="nx">pngquant</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'imagemin-pngquant'</span><span class="p">),</span>
    <span class="nx">jpegtran</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'imagemin-jpegtran'</span><span class="p">),</span>
    <span class="nx">gifsicle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'imagemin-gifsicle'</span><span class="p">),</span>
    <span class="nx">optipng</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'imagemin-optipng'</span><span class="p">),</span>
    <span class="nx">replace</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-replace'</span><span class="p">),</span>
    <span class="nx">glob</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'glob'</span><span class="p">),</span>
    <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">),</span>
    <span class="nx">concat</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-concat-util'</span><span class="p">),</span>
    <span class="nx">uncss</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-uncss'</span><span class="p">),</span>
    <span class="nx">critical</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'critical'</span><span class="p">);</span>
    <span class="nx">download</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'gulp-download'</span><span class="p">);</span>

<span class="c1">// Jekyll</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'jekyll'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">,</span> <span class="p">{</span> <span class="na">read</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">shell</span><span class="p">([</span><span class="s1">'jekyll build'</span><span class="p">]));</span>
<span class="p">});</span>

<span class="c1">// HTML</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'optimize-html'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'_site/**/*.html'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">minifyHTML</span><span class="p">({</span>
            <span class="na">quotes</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;link href=</span><span class="se">\"\/</span><span class="sr">css</span><span class="se">\/</span><span class="sr">style.scss</span><span class="se">\"[^</span><span class="sr">&gt;</span><span class="se">]</span><span class="sr">*&gt;/</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">'_site/css/style.scss'</span><span class="p">,</span> <span class="s1">'utf8'</span><span class="p">);</span>
            <span class="k">return</span> <span class="s1">'&lt;style&gt;</span><span class="err">\</span><span class="s1">n'</span> <span class="o">+</span> <span class="nx">style</span> <span class="o">+</span> <span class="s1">'</span><span class="err">\</span><span class="s1">n&lt;/style&gt;'</span><span class="p">;</span>
        <span class="p">}))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'_site/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Javascript</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'javascript'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'jekyll'</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'js/main.js'</span><span class="p">,</span> <span class="p">{</span> <span class="na">read</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">shell</span><span class="p">([</span><span class="s1">'jspm install'</span><span class="p">]))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">shell</span><span class="p">([</span><span class="s1">'jspm bundle-sfx js/main _site/js/min.js --minify --no-mangle'</span><span class="p">]));</span>
<span class="p">});</span>

<span class="c1">// CSS</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'optimize-css'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'_site/css/style.scss'</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">autoprefixer</span><span class="p">())</span>
       <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">uncss</span><span class="p">({</span>
           <span class="na">html</span><span class="p">:</span> <span class="p">[</span><span class="s1">'_site/**/*.html'</span><span class="p">],</span>
           <span class="na">ignore</span><span class="p">:</span> <span class="p">[]</span>
       <span class="p">}))</span>
       <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">minifyCss</span><span class="p">({</span><span class="na">keepBreaks</span><span class="p">:</span> <span class="kc">false</span><span class="p">}))</span>
       <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'_site/css/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Eliminate render-blocking CSS</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'include-css'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'_site/**/*.html'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;link href=</span><span class="se">\"\/</span><span class="sr">css</span><span class="se">\/</span><span class="sr">style.scss</span><span class="se">\"[^</span><span class="sr">&gt;</span><span class="se">]</span><span class="sr">*&gt;/</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">'_site/css/style.scss'</span><span class="p">,</span> <span class="s1">'utf8'</span><span class="p">);</span>
      <span class="k">return</span> <span class="s1">'&lt;style&gt;</span><span class="err">\</span><span class="s1">n'</span> <span class="o">+</span> <span class="nx">style</span> <span class="o">+</span> <span class="s1">'</span><span class="err">\</span><span class="s1">n&lt;/style&gt;'</span><span class="p">;</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'_site/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Eliminate render-blocking CSS in above-the-fold content</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'styles:critical'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">'src/sass/critical.css'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">minifyCSS</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">concat</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="s1">'&lt;style&gt;'</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">concat</span><span class="p">.</span><span class="nx">footer</span><span class="p">(</span><span class="s1">'&lt;/style&gt;'</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">rename</span><span class="p">({</span>
        <span class="na">basename</span><span class="p">:</span> <span class="s1">'criticalCSS'</span><span class="p">,</span>
        <span class="na">extname</span><span class="p">:</span> <span class="s1">'.html'</span>
      <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'_includes/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Optimize Images</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'optimize-images'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span><span class="s1">'_site/**/*.jpg'</span><span class="p">,</span> <span class="s1">'_site/**/*.jpeg'</span><span class="p">,</span> <span class="s1">'_site/**/*.gif'</span><span class="p">,</span> <span class="s1">'_site/**/*.png'</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">imagemin</span><span class="p">({</span>
        <span class="na">progressive</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">svgoPlugins</span><span class="p">:</span> <span class="p">[{</span><span class="na">removeViewBox</span><span class="p">:</span> <span class="kc">false</span><span class="p">}],</span>
        <span class="na">use</span><span class="p">:</span> <span class="p">[</span><span class="nx">pngquant</span><span class="p">(),</span> <span class="nx">jpegtran</span><span class="p">(),</span> <span class="nx">gifsicle</span><span class="p">()]</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'_site/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Purge cache</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'purge-cache'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">token</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cloudflareToken</span><span class="p">,</span>
        <span class="na">email</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cloudflareEmail</span><span class="p">,</span>
        <span class="na">domain</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">cloudflareDomain</span>
    <span class="p">};</span>
    <span class="nx">cloudflare</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Remove unused CSS</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'uncss'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span>
      <span class="s1">'css/style.scss'</span>
    <span class="p">])</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">uncss</span><span class="p">({</span>
      <span class="na">html</span><span class="p">:</span> <span class="p">[</span>
        <span class="c1">// your site pages here</span>
        <span class="s1">'http://127.0.0.1:4000/'</span><span class="p">,</span>
      <span class="p">]</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'css/uncss/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Google Analytics</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'fetch-analytics'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">download</span><span class="p">(</span><span class="s1">'https://www.google-analytics.com/analytics.js'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'assets/'</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Run (Default)</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'javascript'</span><span class="p">,</span> <span class="s1">'optimize-css'</span><span class="p">,</span> <span class="s1">'include-css'</span><span class="p">,</span>  <span class="s1">'optimize-html'</span><span class="p">,</span> <span class="s1">'optimize-images'</span><span class="p">,</span> <span class="s1">'styles:critical'</span><span class="p">,</span> <span class="s1">'fetch-analytics'</span><span class="p">]);</span>

<span class="c1">// Run: Build</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'build'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'javascript'</span><span class="p">,</span> <span class="s1">'optimize-css'</span><span class="p">,</span> <span class="s1">'include-css'</span><span class="p">,</span>  <span class="s1">'optimize-html'</span><span class="p">,</span> <span class="s1">'optimize-images'</span><span class="p">,</span> <span class="s1">'styles:critical'</span><span class="p">,</span> <span class="s1">'fetch-analytics'</span><span class="p">]);</span>

<span class="c1">// Run: Clean</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'clean'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'uncss'</span><span class="p">]);</span>
</code></pre></div></div>

<hr />

<h2 id="updates">Updates</h2>

<h3 id="leveraging-browser-caching">Leveraging browser caching</h3>
<p>Since sharing my original post, I’ve since found a way to resolve the persistent “Leverage browser caching” issue, which was ironically referencing Google’s own analytics tools.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Google Analytics</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">'fetch-analytics'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">download</span><span class="p">(</span><span class="s1">'https://www.google-analytics.com/analytics.js'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">'assets/'</span><span class="p">));</span> <span class="c1">// or whatever folder you want it in</span>
<span class="p">});</span>
</code></pre></div></div>

<p>This way, a new version of the <code class="highlighter-rouge">analytics.js</code> file is downloaded on each deployment, rather than utilizing Google’s remote file. Therefore, you should also instead include your local <code class="highlighter-rouge">analytics.js</code> file in your html.</p>

<!--------------------------------- Links ------------------------------------->


            <a href="#" id="back-to-top" title="Back to Top"><img src="/assets/img/top-arrow.png" alt="Back to Top"/></a>
            <div class="post-tags-container">
              <span>Tags:&nbsp;</span> 
              
              
              <ul class="post-tags inline">
              
                
                <li class="post-tag-item"><a href="/tags/#jekyll-tag">Jekyll</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#web-development-tag">Web Development</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#performance-tag">Performance</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#gulp-tag">Gulp</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#javascript-tag">Javascript</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#node-js-tag">Node.js</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#github-pages-tag">GitHub Pages</a></li>
              
                
                <li class="post-tag-item"><a href="/tags/#cloudflare-tag">Cloudflare</a></li>
              
              </ul>
            </div>
            <div class="post-closer cf">
              <div class="isLeft">
                <section class="author">
                  <div class="author-image" alt="avatar" style="background-image: url(/assets/img/avatar.png)"></div>
                  <div class="author-info">
                    <h4>Brett Stevenson</h4>
                    
                    <hr>
                    <p class="sub published">Published <time datetime="2017-04-10">April 10, 2017</time></p>
                    
                  </div>
                </section>
              </div>
              <div class="isRight">
                <h5>Share this post</h5>
                <div class="share-button">
  <div class="lid"><span class="fas fa-share-alt" title="Share"></span></div>
  <div class="share-items-wrapper">
      <div class="share-items">
        
          <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fbrettstevenson.io&quote=" title="Share on Facebook" target="_blank" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(document.URL) + '&quote=' + encodeURIComponent(document.URL)); return false;" class="share-item facebook">      
            <span class="fab fa-facebook-f" title="Share on Facebook"></span>
          </a>
        
        
          <a href="/blog/optimizing-jekyll.html" data-show-count="false" class="share-item twitter">
            <span class="fab fa-twitter" title="Tweet"></span>
          </a>
        
        
          <a href="https://plus.google.com/share?url=http%3A%2F%2Fbrettstevenson.io" target="_blank" title="Share on Google+" onclick="window.open('https://plus.google.com/share?url=' + encodeURIComponent(document.URL)); return false;" class="share-item google-plus">
            <span class="fab fa-google-plus-g" title="Share on Google+"></span>
          </a>
        
        
          <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=/blog/optimizing-jekyll.html" class="share-item linkedin popup">
            <span class="fab fa-linkedin-in" title="Share on LinkedIn"></span>
          </a>
        
        
          <a href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fbrettstevenson.io&description=" target="_blank" title="Pin it" onclick="window.open('http://pinterest.com/pin/create/button/?url=' + encodeURIComponent(document.URL) + '&description=' +  encodeURIComponent(document.title)); return false;" class="share-item pinterest">
            <span class="fab fa-pinterest-p" title="Pin it"></span>
          </a>
        
        
        
          <a href="http://www.reddit.com/submit?url=http%3A%2F%2Fbrettstevenson.io&title=" target="_blank" title="Submit to Reddit" onclick="window.open('http://www.reddit.com/submit?url=' + encodeURIComponent(document.URL) + '&title=' +  encodeURIComponent(document.title)); return false;" class="share-item reddit">
            <span class="fab fa-reddit-alien" title="Post on Reddit"></span>
          </a>
        
        
        
          <a href="mailto:?subject=Optimizing%20Jekyll&amp;body=/blog/optimizing-jekyll.html" target="_blank" class="share-item email" data-proofer-ignore>
            <span class="fas fa-at" title="Share via email"></span>
          </a>
        
      </div>
    </div>
  <div class="thank-you">Thank you</div>
</div>

              </div>
            </div>
          </section>
        </div>
        <div class="PageNavigation">
          
            <a class="prev" href="/blog/site-reconstruction.html">
              <span class="fas fa-chevron-left"></span> &nbsp;Site Reconstruction...</a>
          
          
            <a class="next" href="/blog/projects/urban-dictionary-therapy.html">Urban Dictionary Therapy&nbsp; <span class="fas fa-chevron-right"></span></a>
          
        </div>
      
      
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'brettstevenson'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      
    </div>
  </body>
  <script>document.documentElement.classList.remove("no-js");</script>
  <script src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" async></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js" async></script>
<script src="/assets/js/main.js" type="text/javascript" async></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.poptrox/2.5.1/jquery.poptrox.min.js"></script> -->

<script>window.FontAwesomeConfig = { searchPseudoElements: true }</script>
<script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js"integrity="sha384-8iPTk2s/jMVj81dnzb/iFR2sdA7u06vHJyyLlAd4snFpCl/SnyUjRrbdJsw1pGIl" crossorigin="anonymous"></script>

<script>
  $('.mid-content .inner').click(function() {
    window.location = $(this).attr('data-link');
    return false;
  });
</script>

<!-- <script>
  import SweetScroll from 'sweet-scroll';
  document.addEventListener("DOMContentLoaded", () => {
    const sweetScroll = new SweetScroll({ trigger: '.scroll-btn' });
  }, false);
</script> -->


  <script src="/assets/js/scroll-top.js" type="text/javascript"></script>
  <script src="/assets/js/tooltipster.js"></script>
  <script>
    $('.written-content').children('img').each(function() {
      $(this).attr('class','post-img')
      $(this).attr('data-mfp-src',$(this).attr('src'))
      $(this).attr('data-full',$(this).attr('src'))
      $(this).attr('desc',$(this).attr('alt'))
      $(this).attr('data-effect','mfp-zoom-in')
    });
  </script>
  <script>
    $(function() {
      clip = $('<img />').attr({'class':'clipboard tooltip', 'src':'/assets/img/clipboard.png', 'alt':'Copy to clipboard', 'title':'Copied to clipboard' });
      $('pre.highlight').append(clip);
      $(".tooltip").tooltipster({
        animation: "fade",
        trigger: "click",
        delay: 200
      });
      $('pre.highlight .clipboard').on('click', function(e) {
        e.preventDefault();
        var temp = document.createElement('input');
        temp.setAttribute('value', $(this).parent().children('code').text()),
        document.body.appendChild(temp),
        temp.select(),
        document.execCommand('copy'),
        document.body.removeChild(temp)
      })
    });
    
    $('.share-button').on('click', function() {  
      $(this).addClass('open');
    });
    $('.share-items').draggable({ 
      axis: 'x',
      containment: '.share-items-wrapper'
    });
    $('.share-item').on('click', function() {
       $('.share-button').addClass('shared');
       setTimeout(function() {
        $('.share-button').addClass('thankyou');
      }, 800);
      setTimeout(function() {
        $('.share-button').removeClass('open');
        $('.share-button').removeClass('shared');
        $('.share-button').removeClass('thankyou');
      }, 2500);
    });
  </script>












  <footer id="footer">
  <ul class="icons inline">
    
      
        
          <li><a target="_blank" href="https://github.com/tterb" rel="noopener"><span class="fab fa-fw fa-github"></span></a></li>
        
      
    
      
        
          <li><a target="_blank" href="https://bstevenson.deviantart.com/" rel="noopener"><span class="fab fa-fw fa-deviantart"></span></a></li>
        
      
    
      
        
          <li><a target="_blank" href="https://twitter.com/BStevensonDev" rel="noopener"><span class="fab fa-fw fa-twitter"></span></a></li>
        
      
    
      
        
          <li><a target="_blank" href="https://dribbble.com/tterb" rel="noopener"><span class="fab fa-fw fa-dribbble"></span></a></li>
        
      
    
      
        
          <li><a target="_blank" href="https://www.linkedin.com/in/brett-stevenson-0a035a72" rel="noopener"><span class="fab fa-fw fa-linkedin-in"></span></a></li>
        
      
    
      
        
          <li><a href="/contact/"><span class="fas fa-fw fa-envelope"></span></a></li>
        
      
    
  </ul>
  <ul class="copyright inline">
    <li>&copy;
      
      
        
        
          2015,
        
      
      2018
      <a href="/">
        
          Brett Stevenson
        
      </a>
    </li>
    <!-- <li><i class="fa fa-code"></i> with <i class="fa fa-heart"></i>&nbsp;</li> -->
    <li>Powered by <a href="http://jekyllrb.com" class="jekyll-link" role="link" target="_blank" rel="noopener">Jekyll</a></li>
  </ul>
</footer>

</html>
